(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[435],{285:(e,s,t)=>{"use strict";t.d(s,{$:()=>d});var a=t(5155),r=t(2115),n=t(4624),i=t(2085),l=t(9434);let c=(0,i.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,s)=>{let{className:t,variant:r,size:i,asChild:d=!1,...o}=e,m=d?n.DX:"button";return(0,a.jsx)(m,{className:(0,l.cn)(c({variant:r,size:i,className:t})),ref:s,...o})});d.displayName="Button"},646:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},1007:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},1029:(e,s,t)=>{"use strict";t.d(s,{J:()=>m});var a=t(5155),r=t(2115);t(7650);var n=t(4624),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,s)=>{let t=(0,n.TL)(`Primitive.${s}`),i=r.forwardRef((e,r)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,a.jsx)(n?t:s,{...i,ref:r})});return i.displayName=`Primitive.${s}`,{...e,[s]:i}},{}),l=r.forwardRef((e,s)=>(0,a.jsx)(i.label,{...e,ref:s,onMouseDown:s=>{var t;s.target.closest("button, input, select, textarea")||(null==(t=e.onMouseDown)||t.call(e,s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));l.displayName="Label";var c=t(2085),d=t(9434);let o=(0,c.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),m=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l,{ref:s,className:(0,d.cn)(o(),t),...r})});m.displayName=l.displayName},1366:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]])},4861:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},5169:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5695:(e,s,t)=>{"use strict";var a=t(8999);t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},5752:(e,s,t)=>{Promise.resolve().then(t.bind(t,9423))},6695:(e,s,t)=>{"use strict";t.d(s,{BT:()=>d,Wu:()=>o,ZB:()=>c,Zp:()=>i,aR:()=>l});var a=t(5155),r=t(2115),n=t(9434);let i=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...r})});i.displayName="Card";let l=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...r})});l.displayName="CardHeader";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("h3",{ref:s,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...r})});c.displayName="CardTitle";let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("p",{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",t),...r})});d.displayName="CardDescription";let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("p-6 pt-0",t),...r})});o.displayName="CardContent",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",t),...r})}).displayName="CardFooter"},9074:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},9420:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]])},9423:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>k,runtime:()=>b});var a=t(5155),r=t(2115),n=t(5695),i=t(285),l=t(6695),c=t(1029);let d=(0,t(9946).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var o=t(646),m=t(4861),x=t(5169),h=t(9420),u=t(1366),p=t(9074),g=t(1007),f=t(7930),j=t(6874),y=t.n(j),v=t(6766),N=t(3568);let b="edge";function k(){let e=(0,n.useRouter)(),s=(0,n.useParams)(),[t,j]=(0,r.useState)(null),[b,k]=(0,r.useState)(!0),[w,A]=(0,r.useState)(!1),[B,C]=(0,r.useState)(""),[P,R]=(0,r.useState)(""),D=(0,r.useCallback)(async()=>{try{let t=localStorage.getItem("adminToken"),a=await fetch("/api/admin/bookings/".concat(s.id),{headers:{Authorization:"Bearer ".concat(t)}});if(a.ok){let e=await a.json();j(e.booking),C(e.booking.status),R(e.booking.notes||"")}else N.Ay.error("Failed to fetch booking details"),e.push("/admin/bookings")}catch(e){console.error("Error fetching booking:",e),N.Ay.error("Failed to load booking details")}finally{k(!1)}},[s.id,e]);(0,r.useEffect)(()=>{if(!localStorage.getItem("adminToken"))return void e.push("/admin/login");D()},[e,s.id,D]);let S=async()=>{if(t){A(!0);try{let e=localStorage.getItem("adminToken");(await fetch("/api/admin/bookings/".concat(s.id),{method:"PATCH",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({status:B,notes:P})})).ok?(N.Ay.success("Booking updated successfully"),D()):N.Ay.error("Failed to update booking")}catch(e){console.error("Error updating booking:",e),N.Ay.error("Failed to update booking")}finally{A(!1)}}},T=e=>new Date(e).toLocaleDateString("en-BD",{year:"numeric",month:"long",day:"numeric"});return b?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading booking details..."})]})}):t?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,a.jsx)("div",{className:"container-mobile py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(y(),{href:"/admin/bookings",children:(0,a.jsxs)(i.$,{variant:"outline",size:"sm",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Back to Bookings"]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Booking Details"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Booking ID: ",t.id]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("a",{href:"tel:".concat(t.passenger.phone),children:(0,a.jsxs)(i.$,{variant:"outline",size:"sm",children:[(0,a.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Call"]})}),(0,a.jsx)("a",{href:"https://wa.me/".concat(t.passenger.phone.replace(/\D/g,"")),target:"_blank",rel:"noopener noreferrer",children:(0,a.jsxs)(i.$,{variant:"outline",size:"sm",children:[(0,a.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"WhatsApp"]})})]})]})})}),(0,a.jsx)("div",{className:"container-mobile py-8",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsxs)(l.Zp,{children:[(0,a.jsx)(l.aR,{children:(0,a.jsxs)(l.ZB,{className:"flex items-center",children:[(0,a.jsx)(p.A,{className:"h-5 w-5 mr-2"}),"Booking Information"]})}),(0,a.jsxs)(l.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(c.J,{className:"text-sm font-medium text-gray-600",children:"Date"}),(0,a.jsx)("p",{className:"text-lg font-semibold",children:T(t.bookingDate)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(c.J,{className:"text-sm font-medium text-gray-600",children:"Pickup Time"}),(0,a.jsx)("p",{className:"text-lg font-semibold",children:(e=>{let[s,t]=e.split(":"),a=parseInt(s);return"".concat(a%12||12,":").concat(t," ").concat(a>=12?"PM":"AM")})(t.pickupTime)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(c.J,{className:"text-sm font-medium text-gray-600",children:"Trip Type"}),(0,a.jsxs)("p",{className:"text-lg font-semibold capitalize",children:[t.tripType," Trip"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(c.J,{className:"text-sm font-medium text-gray-600",children:"Status"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat((e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"confirmed":return"bg-green-100 text-green-800";case"completed":return"bg-blue-100 text-blue-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(t.status)),children:t.status}),(e=>{switch(e){case"pending":default:return(0,a.jsx)(d,{className:"h-4 w-4"});case"confirmed":case"completed":return(0,a.jsx)(o.A,{className:"h-4 w-4"});case"cancelled":return(0,a.jsx)(m.A,{className:"h-4 w-4"})}})(t.status)]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(c.J,{className:"text-sm font-medium text-gray-600",children:"Pickup Location"}),(0,a.jsx)("p",{className:"text-lg font-semibold",children:t.pickupLocation})]}),t.dropoffLocation&&(0,a.jsxs)("div",{children:[(0,a.jsx)(c.J,{className:"text-sm font-medium text-gray-600",children:"Drop-off Location"}),(0,a.jsx)("p",{className:"text-lg font-semibold",children:t.dropoffLocation})]})]})]}),(0,a.jsxs)(l.Zp,{children:[(0,a.jsx)(l.aR,{children:(0,a.jsxs)(l.ZB,{className:"flex items-center",children:[(0,a.jsx)(g.A,{className:"h-5 w-5 mr-2"}),"Passenger Information"]})}),(0,a.jsx)(l.Wu,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(c.J,{className:"text-sm font-medium text-gray-600",children:"Name"}),(0,a.jsx)("p",{className:"text-lg font-semibold",children:t.passenger.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(c.J,{className:"text-sm font-medium text-gray-600",children:"Phone"}),(0,a.jsx)("p",{className:"text-lg font-semibold",children:t.passenger.phone})]}),t.passenger.email&&(0,a.jsxs)("div",{children:[(0,a.jsx)(c.J,{className:"text-sm font-medium text-gray-600",children:"Email"}),(0,a.jsx)("p",{className:"text-lg font-semibold",children:t.passenger.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(c.J,{className:"text-sm font-medium text-gray-600",children:"Verification Status"}),(0,a.jsx)("div",{className:"flex items-center space-x-2",children:t.passenger.isVerified?(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Verified"}):(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Not Verified"})})]})]})})]}),(0,a.jsxs)(l.Zp,{children:[(0,a.jsx)(l.aR,{children:(0,a.jsxs)(l.ZB,{className:"flex items-center",children:[(0,a.jsx)(f.A,{className:"h-5 w-5 mr-2"}),"Vehicle Information"]})}),(0,a.jsx)(l.Wu,{children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[t.vehicle.photos&&t.vehicle.photos.length>0?(0,a.jsx)(v.default,{src:t.vehicle.photos[0].url,alt:t.vehicle.photos[0].alt,width:80,height:80,className:"w-20 h-20 object-cover rounded-lg"}):(0,a.jsx)("div",{className:"w-20 h-20 bg-gray-200 rounded-lg flex items-center justify-center",children:(0,a.jsx)(f.A,{className:"h-8 w-8 text-gray-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:t.vehicle.name}),(0,a.jsx)("p",{className:"text-gray-600 capitalize",children:t.vehicle.type}),(0,a.jsxs)("p",{className:"text-gray-600",children:[t.vehicle.capacity," seats"]})]})]})})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(l.Zp,{children:[(0,a.jsxs)(l.aR,{children:[(0,a.jsx)(l.ZB,{children:"Update Booking"}),(0,a.jsx)(l.BT,{children:"Change booking status and add notes"})]}),(0,a.jsxs)(l.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(c.J,{htmlFor:"status",children:"Status"}),(0,a.jsxs)("select",{id:"status",value:B,onChange:e=>C(e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,a.jsx)("option",{value:"pending",children:"Pending"}),(0,a.jsx)("option",{value:"confirmed",children:"Confirmed"}),(0,a.jsx)("option",{value:"completed",children:"Completed"}),(0,a.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(c.J,{htmlFor:"notes",children:"Notes"}),(0,a.jsx)("textarea",{id:"notes",value:P,onChange:e=>R(e.target.value),placeholder:"Add notes about this booking...",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary-500",rows:3})]}),(0,a.jsx)(i.$,{onClick:S,disabled:w,className:"w-full",children:w?"Updating...":"Update Booking"})]})]}),(0,a.jsxs)(l.Zp,{children:[(0,a.jsx)(l.aR,{children:(0,a.jsx)(l.ZB,{children:"Booking Timeline"})}),(0,a.jsx)(l.Wu,{children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-primary-500 rounded-full"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"Booking Created"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:T(t.createdAt)})]})]}),t.notifications&&t.notifications.length>0?t.notifications.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("sent"===e.status?"bg-green-500":"bg-yellow-500")}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm font-medium",children:["whatsapp"===e.type?"WhatsApp Notification":"Notification","sent"===e.status?" Sent":" Pending"]}),e.sentAt&&(0,a.jsx)("p",{className:"text-xs text-gray-600",children:T(e.sentAt)})]})]},e.id)):(0,a.jsx)("div",{className:"text-center py-4",children:(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"No notifications sent"})})]})})]})]})]})})]}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsx)(l.Zp,{className:"max-w-md",children:(0,a.jsxs)(l.Wu,{className:"p-8 text-center",children:[(0,a.jsx)(m.A,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Booking Not Found"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"The booking you're looking for doesn't exist or has been removed."}),(0,a.jsx)(y(),{href:"/admin/bookings",children:(0,a.jsxs)(i.$,{className:"btn-mobile",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Back to Bookings"]})})]})})})}},9434:(e,s,t)=>{"use strict";t.d(s,{Q7:()=>l,Yq:()=>c,cn:()=>n,fU:()=>d,n4:()=>i});var a=t(2596),r=t(9688);function n(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,r.QP)((0,a.$)(s))}function i(e){let s=e.replace(/\D/g,"");return 10===s.length&&!s.startsWith("880")||11===s.length&&s.startsWith("01")?"+880".concat(s):e.startsWith("+")?e:"+".concat(s)}function l(e){let s=e.replace(/\D/g,"");return s.length>=10&&s.length<=15}function c(e){return new Intl.DateTimeFormat("en-BD",{year:"numeric",month:"long",day:"numeric"}).format(e)}function d(e){let[s,t]=e.split(":"),a=parseInt(s);return"".concat(a%12||12,":").concat(t," ").concat(a>=12?"PM":"AM")}}},e=>{e.O(0,[66,568,395,441,964,358],()=>e(e.s=5752)),_N_E=e.O()}]);