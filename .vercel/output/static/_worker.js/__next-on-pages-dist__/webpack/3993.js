var d={},w=(S,D,L)=>(d.__chunk_3993=(v,g,p)=>{"use strict";p.d(g,{_:()=>_});class f{constructor(e){this.config=e}async query(e,s=[]){try{let{accountId:r,apiToken:i,databaseId:u}=this.config;if(!r||!i||!u)return{success:!1,error:"Missing Cloudflare D1 credentials"};let n=e;s.length>0&&s.forEach((t,E)=>{let l,m=`$${E+1}`;l=t==null?"NULL":typeof t=="string"?`'${t.replace(/'/g,"''")}'`:typeof t=="number"?t.toString():typeof t=="boolean"?t?"1":"0":`'${String(t).replace(/'/g,"''")}'`,n=n.replace(RegExp(m,"g"),l)});let A=`https://api.cloudflare.com/client/v4/accounts/${r}/d1/database/${u}/query`,a=await fetch(A,{method:"POST",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},body:JSON.stringify({sql:n})});if(!a.ok){let t=await a.json();return{success:!1,error:`D1 API Error: ${JSON.stringify(t)}`}}let c=await a.json();return{success:!0,data:c.result?.[0]?.results||[],meta:{changes:c.result?.[0]?.changes||0,last_row_id:c.result?.[0]?.last_row_id||0,duration:c.result?.[0]?.duration||0}}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Unknown error occurred"}}}}class y{constructor(e){this.config=e}async query(e,s=[]){try{return{success:!1,error:"PostgreSQL provider not implemented yet"}}catch(r){return{success:!1,error:r instanceof Error?r.message:"PostgreSQL query failed"}}}async close(){}}class h{constructor(e){this.config=e}async query(e,s=[]){try{return{success:!1,error:"MySQL provider not implemented yet"}}catch(r){return{success:!1,error:r instanceof Error?r.message:"MySQL query failed"}}}async close(){}}class _{static createProvider(e,s){switch(e){case"cloudflare-d1":return new f(s);case"postgresql":return new y(s);case"mysql":return new h(s);default:throw Error(`Unsupported database type: ${e}`)}}static getDefaultProvider(){let e=process.env.DATABASE_TYPE||"cloudflare-d1",s={accountId:process.env.CLOUDFLARE_ACCOUNT_ID,apiToken:process.env.CLOUDFLARE_API_TOKEN,databaseId:process.env.CLOUDFLARE_D1_DATABASE_ID,connectionString:process.env.DATABASE_URL,region:process.env.DATABASE_REGION};return this.createProvider(e,s)}}},d);export{w as __getNamedExports};
